### Vulnerability labeling
vulnerability_type_detection_patterns = {
    "Remote Code Execution Vulnerability": "Remote Code Execution",
    "Remote Code Execution Injection Vulnerability": "Remote Code Execution",
    "Remote Code Execution Injection": "Remote Code Execution",
    "Unsigned Code Execution Vulnerability": "Remote Code Execution",
    'Authenticated Remote Code Execution Vulnerability': "Remote Code Execution",
    "Denial of Service Vulnerability": "Denial of Service",
    "Denial of Service": "Denial of Service",
    "Denial Of Service Vulnerability": "Denial of Service",
    "Denial Of Service": "Denial of Service",
    "Buffer Overflow": "Memory Corruption",
    "Buffer Overflow Vulnerability": "Memory Corruption",
    "Elevation of Privilege Vulnerability": "Elevation of Privilege",
    "Elevation Of Privilege": "Elevation of Privilege",
    "Elevation of Privileged Vulnerability": "Elevation of Privilege",
    "Elevation of Privileged": "Elevation of Privilege",
    "XSS Vulnerability": "Cross Site Scripting",
    "XSS Filter Vulnerability": "Cross Site Scripting",
    "XSS Filter": "Cross Site Scripting",
    "Cross Site Scripting Vulnerability": "Cross Site Scripting",
    "Cross-Site Scripting Vulnerability": "Cross Site Scripting",
    "Cross-site Scripting Vulnerability": "Cross Site Scripting",
    "Memory Corruption Vulnerability": "Memory Corruption",
    "Heap Overflow Vulnerability": "Memory Corruption",
    "Heap Overflow": "Memory Corruption",
    "Authentication Bypass Vulnerability": "Authentication Bypass",
    "Security Feature Bypass Vulnerability": "Security Feature Bypass",
    "Security Feature Bypass": "Security Feature Bypass",
    "Spoofing Vulnerability": "Spoofing",
    "Information Disclosure Vulnerability": "Information Disclosure",
    "HTML Injection Vulnerability": "Code Injection",
    "Open Redirect Vulnerability": "Open Redirect",
    "Tampering Vulnerability": "Tampering",
}


vulnerability_type_data = {
    "Remote Code Execution": {
        "criticality": 1.0,
        "additional_detection_strings": ["Unsigned Code Execution",
                                         "script to be executed",
                                         "arbitrary code execution",
                                         "execute arbitrary code",
                                         "Out of bounds write",
                                         "to execute code on",
                                         "allowed a remote attacker to execute",
                                         "instruction injection",
                                         "able to execute code",
                                         "to execute code with elevated privileges",
                                         "code execution",
                                         "allow an unauthenticated attacker to remotely compromise",
                                         "remotely execute code",
                                         "execution of code",
                                         "RCE",
                                         "execute arbitrary JavaScript code",
                                         "to execute code",
                                         "execution of arbitrary code",
                                         "to execute arbitrary GStreamer plugins",
                                         "embedded malicious code", # Supply Chain Attacks
                                         "execute unauthorized code",
                                         "execute remote code",
                                         "выполнить произвольный код"
                                         ],

        "icon": "rce"
    },
    "Authentication Bypass": {
        "criticality": 0.98,
        "additional_detection_strings": ["result in takeover of",
                                         "authentication can be bypassed",
                                         "create an administrative account",
                                         "bypass authentication",
                                         "may bypass iControl REST authentication",
                                         "access data without proper authorization",
                                         "to become an administrator",
                                         "unauthorized access to critical data",
                                         "may lead to gaining access to the backup infrastructure hosts",
                                         "create an account on an affected system",
                                         "create unauthorized Confluence administrator accounts",
                                         "create unauthorized accounts",
                                         "create unauthorized administrator accounts",
                                         "create administrator accounts",
                                         "gain admin access",
                                         "missing or wrong authorization checks",
                                         "Missing Authentication for Critical Function",
                                         "Improper Authorization",
                                         "authorization bypass",
                                         "usurpation of administrative privileges",
                                         "access is allowed to everyone",
                                         "gain unauthorized access",
                                         "access certain restricted resources without authentication"],
        "cwes": [
            "CWE-276",  # CWE-276: Incorrect Default Permissions
            "CWE-303",  # CWE-303: Incorrect Implementation of Authentication Algorithm
            "CWE-1390",  # 1390	Weak Authentication
            "CWE-304",  # 304	Missing Critical Step in Authentication
            "CWE-262",  # 262	Not Using Password Aging
            "CWE-263",  # 263	Password Aging with Long Expiration
            "CWE-287",  # CWE-287 Improper Authentication
            "CWE-306",  # CWE-306 Missing Authentication for Critical Function
            "CWE-1390",  # CWE-1390 Weak Authentication
            "CWE-289",  # 289	Authentication Bypass by Alternate Name
            "CWE-290",  # 290	Authentication Bypass by Spoofing
            "CWE-294",  # 294	Authentication Bypass by Capture-replay
            "CWE-301",  # 301	Reflection Attack in an Authentication Protocol
            "CWE-302",  # 302	Authentication Bypass by Assumed-Immutable Data
            "CWE-303",  # 303	Incorrect Implementation of Authentication Algorithm
            "CWE-305",  # 305	Authentication Bypass by Primary Weakness
            "CWE-307",  # 307	Improper Restriction of Excessive Authentication Attempts
            "CWE-308",  # 308	Use of Single-factor Authentication
            "CWE-309",  # 309	Use of Password System for Primary Authentication
            "CWE-522",  # 522	Insufficiently Protected Credentials
            "CWE-593",  # 593	Authentication Bypass: OpenSSL CTX Object Modified after SSL Objects are Created
            "CWE-603",  # 603	Use of Client-Side Authentication
            "CWE-620",  # 620	Unverified Password Change
            "CWE-640",  # 640	Weak Password Recovery Mechanism for Forgotten Password
            "CWE-804",  # 804	Guessable CAPTCHA
            "CWE-836",  # 836	Use of Password Hash Instead of Password for Authentication
            "CWE-1391",  # 1391 Use of Weak Credentials
            "CWE-284",  # CWE-284 Improper Access Control
        ],
        "icon": "auth_bypass"
    },
    "Code Injection": {
        "criticality": 0.97,
        "additional_detection_strings": ["inject malicious code",
                                         "SQL Injection",
                                         "SQL-Injection",
                                         "insert cookies", #??
                                         "LDAP injection vulnerability"], #??
        "cwes": [
            "CWE-89", # CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
            "CWE-94", # CWE-94 Improper Control of Generation of Code ('Code Injection')
        ],
        "icon": "code_injection"
    },
    "XXE Injection": {
        "criticality": 0.97,
        "additional_detection_strings": ["XML External Entity injection", "XXE"],
        "icon": "xxe_injection"
    },
    "Command Injection": {
        "criticality": 0.97,
        "additional_detection_strings": ["inject command",
                                         "inject arbitrary commands",
                                         "remote command execution",
                                         "unauthorized creation, deletion or modification access to critical data",
                                         "inject arbitrary memcache commands",
                                         "forward the request to", #SSRF
                                         "server-side request forgery", #SSRF
                                         "SSRF", #SSRF
                                         "request smuggling", #Request Smuggling CWE-444
                                         "to modify system files",
                                         "wrong command executed",
                                         "run arbitrary commands",
                                         "arbitrary network requests",
                                         "выполнить команды ОС"],

        "cwes": ["CWE-77",
         ],
        "icon": "command_injection"
    },
    "Arbitrary File Writing": {
        "criticality": 0.95,
        "additional_detection_strings": ["overwrite arbitrary files"],
        "icon": "arb_file_writing"
    },
    "Security Feature Bypass": {
        "criticality": 0.90,
        "additional_detection_strings": ["Security Features Bypass",
                                         "Policy bypass in",
                                         "bypass navigation restrictions",
                                         "bypass site isolation",
                                         "users with guest privileges to upload files",
                                         "effectively bypasses the check",
                                         "untrusted parties have write access",
                                         "complete read-write access",
                                         "Insufficient policy enforcement",
                                         "Insufficient validation",
                                         "Insufficiently protected",
                                         "Insufficient data validation",
                                         "Boot Loader Bypass",
                                         "allowed a remote attacker to force acceptance",
                                         "allowed a remote attacker to bypass",
                                         "bypass the policy mechanism",
                                         "obfuscate a permission prompt",
                                         "obfuscate security UI",
                                         "bypass discretionary access control",
                                         "bypass an enterprise policy",
                                         "to leak cross-origin data",
                                         "not properly verify",
                                         "incorrect permissions being checked",
                                         "obtain ownership of arbitrary files",
                                         "Incorrect Access Control",
                                         "cookie containing invalid characters",
                                         "simulate user inputs",
                                         "not properly parse command lines",
                                         "trick a user into granting permissions",
                                         "to bypass Secure Boot",
                                         "gain access to system secrets",
                                         "obtain encrypted passwords",
                                         "с произвольной модификацией поля",
                                         "OAuth codes did not expire"
                                         ],
        "cwes": [
            "CWE-426", # CWE-426 	Untrusted Search Path - controversial, but I don’t know where it’s better to add this
            "CWE-20", # CWE-20: Improper Input Validation
            "CWE-345", # CWE-345: Insufficient Verification of Data Authenticity
            "CWE-347", # CWE-347: Improper Verification of Cryptographic Signature
            "CWE-295", # CWE-295: Improper Certificate Validation
            "CWE-434", # CWE-434: Unrestricted Upload of File with Dangerous Type
            "CWE-444", # CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')
            "CWE-276", # CWE-276 Incorrect Default Permissions
            "CWE-277", # CWE-277 Insecure Inherited Permissions
            "CWE-278", # CWE-278 Insecure Preserved Inherited Permissions
            "CWE-279", # CWE-279 Incorrect Execution-Assigned Permissions
            "CWE-281", # CWE-281 Improper Preservation of Permissions
            "CWE-502", # CWE-502 Deserialization of Untrusted Data
            #### Protection mechanisms
            "CWE-693", # CWE-693 Protection Mechanism Failure
            "CWE-182", # CWE-182 Collapse of Data into Unsafe Value
            "CWE-184", # CWE-184 Incomplete List of Disallowed Inputs
            "CWE-311", # CWE-311 Missing Encryption of Sensitive Data
            "CWE-326", # CWE-326 Inadequate Encryption Strength
            "CWE-327", # CWE-327 Use of a Broken or Risky Cryptographic Algorithm
            "CWE-330", # CWE-330 Use of Insufficiently Random Values
            "CWE-345", # CWE-345 Insufficient Verification of Data Authenticity
            "CWE-357", # CWE-357 Insufficient UI Warning of Dangerous Operations
            "CWE-358", # CWE-358 Improperly Implemented Security Check for Standard
            "CWE-424", # CWE-424 Improper Protection of Alternate Path
            "CWE-602", # CWE-602 Client-Side Enforcement of Server-Side Security
            "CWE-653", # CWE-653 Improper Isolation or Compartmentalization
            "CWE-654", # CWE-654 Reliance on a Single Factor in a Security Decision
            "CWE-655", # CWE-655 Insufficient Psychological Acceptability
            "CWE-656", # CWE-656 Reliance on Security Through Obscurity
            "CWE-757", # CWE-757 Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade')
            "CWE-778", # CWE-778 Insufficient Logging
            "CWE-807", # CWE-807 Reliance on Untrusted Inputs in a Security Decision
            "CWE-1039", # CWE-1039 Automated Recognition Mechanism with Inadequate Detection or Handling of Adversarial Input Perturbations
            "CWE-1248", # CWE-1248 Semiconductor Defects in Hardware Logic with Security-Sensitive Implications
            "CWE-1253", # CWE-1253 Incorrect Selection of Fuse Values
            "CWE-1269", # CWE-1269 Product Released in Non-Release Configuration
            "CWE-1278", # CWE-1278 Missing Protection Against Hardware Reverse Engineering Using Integrated Circuit (IC) Imaging Techniques
            "CWE-1291", # CWE-1291 Public Key Re-Use for Signing both Debug and Production Code
            "CWE-1318", # CWE-1318 Missing Support for Security Features in On-chip Fabrics or Buses
            "CWE-1319", # CWE-1319 Improper Protection against Electromagnetic Fault Injection (EM-FI)
            "CWE-1326", # CWE-1326 Missing Immutable Root of Trust in Hardware
            "CWE-1338", # CWE-1338 Improper Protections Against Hardware Overheating
            "CWE-331", # CWE-331 Insufficient Entropy
            "CWE-334", # CWE-334 Small Space of Random Values
            "CWE-335", # CWE-335 Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)
            "CWE-338", # CWE-338 Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
            "CWE-340", # CWE-340 Generation of Predictable Numbers or Identifiers
            "CWE-344", # CWE-344 Use of Invariant Value in Dynamically Changing Context
            "CWE-1204", # CWE-1204 Generation of Weak Initialization Vector (IV)
            "CWE-1241", # CWE-1241 Use of Predictable Algorithm in Random Number Generator
            ### Insufficient Verification of Data Authenticity
            "CWE-345", # CWE-345 Insufficient Verification of Data Authenticity
            "CWE-346", # CWE-346 Origin Validation Error
            "CWE-347", # CWE-347 Improper Verification of Cryptographic Signature
            "CWE-348", # CWE-348 Use of Less Trusted Source
            "CWE-349", # CWE-349 Acceptance of Extraneous Untrusted Data With Trusted Data
            "CWE-351", # CWE-351 Insufficient Type Distinction
            "CWE-352", # CWE-352 Cross-Site Request Forgery (CSRF)
            "CWE-353", # CWE-353 Missing Support for Integrity Check
            "CWE-354", # CWE-354 Improper Validation of Integrity Check Value
            "CWE-360", # CWE-360 Trust of System Event Data
            "CWE-494", # CWE-494 Download of Code Without Integrity Check
            "CWE-616", # CWE-616 Incomplete Identification of Uploaded File Variables (PHP)
            "CWE-646", # CWE-646 Reliance on File Name or Extension of Externally-Supplied File
            "CWE-649", # CWE-649 Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking
            "CWE-924", # CWE-924 Improper Enforcement of Message Integrity During Transmission in a Communication Channel
            "CWE-1293", # CWE-1293 Missing Source Correlation of Multiple Independent Data
        ],
        "icon": "sf_bypass"
    },
    "Elevation of Privilege": {
        "criticality": 0.85,
        "additional_detection_strings": ["with elevated permissions",
                                         "privilege escalation",
                                         "Elevation Of Privilege",
                                         "escalate their privileges",
                                         "escalation of privilege",
                                         "Privilege Escalation",
                                         "gain elevated privileges",
                                         "EoP",
                                         "escalate privileges",
                                         "use this flaw to gain root privileges",
                                         "potentially gaining root privileges"],
        "icon": "eop"
    },
    "Information Disclosure": {
        "criticality": 0.83,
        "additional_detection_strings": ["allow the attacker to download the router configuration",
                                         "Side-channel information leakage",
                                         "exposure of sensitive information",
                                         "information leaking",
                                         "become readable by other",
                                         "collect sensitive user data",
                                         "Information Exposure",
                                         "information exposure",
                                         "obtain sensitive information",
                                         "disclose sensitive information",
                                         "to fingerprint the user"],
        "cwes": [
            "CWE-200",
            "CWE-668",  # CWE-668: Exposure of Resource to Wrong Sphere
            "CWE-312",  # CWE-312: Cleartext Storage of Sensitive Information
            "CWE-203",  # CWE-203: Observable Discrepancy
        ],
        "icon": "infdis"
    },
    "Arbitrary File Reading": {
        "criticality": 0.83,
        "additional_detection_strings": ["to exfiltrate media files",
                                         "read arbitrary files"],
        "cwes": [
            "CWE-552", # CWE-552 Files or Directories Accessible to External Parties
            "CWE-219", # CWE-219 Storage of File with Sensitive Data Under Web Root
            "CWE-220", # CWE-220 Storage of File With Sensitive Data Under FTP Root
            "CWE-527", # CWE-527 Exposure of Version-Control Repository to an Unauthorized Control Sphere
            "CWE-528", # CWE-528 Exposure of Core Dump File to an Unauthorized Control Sphere
            "CWE-529", # CWE-529 Exposure of Access Control List Files to an Unauthorized Control Sphere
            "CWE-530", # CWE-530 Exposure of Backup File to an Unauthorized Control Sphere
            "CWE-539", # CWE-539 Use of Persistent Cookies Containing Sensitive Information
            "CWE-553", # CWE-553 Command Shell in Externally Accessible Directory
        ],
        "icon": "arb_file_reading"
    },
    "Cross Site Scripting": {
        "criticality": 0.8,
        "additional_detection_strings": ["Cross-site Scripting",
                                         "Cross-Site Scripting",
                                         "place HTML containing executable JavaScript",
                                         "XSS"],
        "cwes": [
            "CWE-79",  # CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
        ],
        "icon": "xss"
    },
    "Open Redirect": {
        "criticality": 0.75,
        "additional_detection_strings": ["redirected to an arbitrary website"],
        "icon": "open_redirect",
        "cwes": [
            "CWE-601"
        ]
    },
    "Path Traversal": {
        "criticality": 0.7,
        "additional_detection_strings": ["Directory Traversal",
                                         "Directory traversal",
                                         "directory traversal"],
        "cwes": ["CWE-22"  # CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
                 ],
        "icon": "ptrav"
    },
    "Denial of Service": {
        "criticality": 0.7,
        "additional_detection_strings": ["disruption for users of the service",
                                         "to behave incorrectly or crash",
                                         "denial-of-service",
                                         "expend significant CPU time verifying signatures",
                                         "leading to a crash",
                                         "resulting in an application crash",
                                         "cause a crash",
                                         "out-of-bounds and crash",
                                         "server will terminate the connection",
                                         "DoS",
                                         "application crash",
                                         "led to a crash",
                                         "potentially exploitable crash",
                                         "unbounded memory growth",
                                         "cause a panic",
                                         "cause a hang",
                                         "repeatable crash",
                                         "crash can occur",
                                         "exhaust CPU resources",
                                         "to crash",
                                         "excessive CPU load"],
        "cwes": [
            "CWE-617",
            "CWE-400", # Uncontrolled Resource Consumption
            "CWE-269", # CWE-269: Improper Privilege Management
            "CWE-1021", # CWE-1021: Improper Restriction of Rendered UI Layers or Frames
            "CWE-835", # CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')
            "CWE-770", # CWE-770 Allocation of Resources Without Limits or Throttling
            "CWE-774", # CWE-774 Allocation of File Descriptors or Handles Without Limits or Throttling
            "CWE-789", # CWE-789 Memory Allocation with Excessive Size Value
            "CWE-1325", # CWE-1325 Improperly Controlled Sequential Memory Allocation
        ],
        "icon": "dos"
    },
    "Memory Corruption": {
        "criticality": 0.5,
        "additional_detection_strings": ["heap corruption",
                                         "Out of bounds memory access",
                                         "out of bounds memory access",
                                         "overflow the buffer",
                                         "pointer/overflow",
                                         "Out of bounds read",
                                         "Use after free",
                                         "buffer overflow",
                                         "Object lifecycle issue",
                                         "Type Confusion",
                                         "cache speculation",
                                         "memory leak",
                                         "memory integrity",
                                         "memory consumption",
                                         "overflow a heap based buffer",
                                         "out-of-bounds read",
                                         "OutOfMemoryError",
                                         "Global-Buffer-Overflow",
                                         "use-after-free",
                                         "used after being freed",
                                         "out-of-bounds write",
                                         "Use After Free",
                                         "Heap-based Buffer Overflow",
                                         "can allocate up to",
                                         "Prototype Pollution",
                                         "Out-Of-Bound Write",
                                         "out of bounds write",
                                         "out of bounds read",
                                         "Out-Of-Bounds Write",
                                         "Out-Of-Bounds Read",
                                         "Out-of-bounds Write",
                                         "Out-of-bounds Read",
                                         "array-bounds overflow",
                                         "read the initial byte of the ORF header",
                                         "may access memory that has been freed",
                                         "trigger a memory exception",
                                         "race condition",
                                         "lead to a stack overflow",
                                         "null pointer deference"],
        "cwes": [
            "CWE-465", "CWE-466", "CWE-468", "CWE-469", "CWE-476", "CWE-587",
            "CWE-763", "CWE-822", "CWE-823", "CWE-824", "CWE-825",
            #####
            "CWE-415", "CWE-666", "CWE-1341", "CWE-825", "CWE-123", # - Double Free
            "CWE-416", # CWE-416 Use After Free
            "CWE-787", # CWE-787 Out-of-bounds Write
            "CWE-125", # CWE-125 Out-of-bounds Read
            "CWE-119", # CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer
            "CWE-118", # CWE-118 Incorrect Access of Indexable Resource ('Range Error')
            "CWE-120", # CWE-120 Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')
            "CWE-125", # CWE-125 Out-of-bounds Read
            "CWE-466", # CWE-466 Return of Pointer Value Outside of Expected Range
            "CWE-786", # CWE-786 Access of Memory Location Before Start of Buffer
            "CWE-787", # CWE-787 Out-of-bounds Write
            "CWE-788", # CWE-788 Access of Memory Location After End of Buffer
            "CWE-805", # CWE-805 Buffer Access with Incorrect Length Value
            "CWE-822", # CWE-822 Untrusted Pointer Dereference
            "CWE-823", # CWE-823 Use of Out-of-range Pointer Offset
            "CWE-824", # CWE-824 Access of Uninitialized Pointer
            "CWE-825", # CWE-825 Expired Pointer Dereference
        ],
        "icon": "memcor"
    },
    "Incorrect Calculation": {
        "criticality": 0.5,
        "additional_detection_strings": ["Integer Overflow",
                                         "Integer overflow",
                                         "integer overflow"],
        "cwes": [
            # Incorrect Calculation
            "CWE-682", "CWE-128", "CWE-131", "CWE-135", "CWE-190", "CWE-191",
            "CWE-193", "CWE-369", "CWE-468", "CWE-469", "CWE-1335", "CWE-1339",
            "CWE-755",  # CWE-755: Improper Handling of Exceptional Conditions
            "CWE-686",  # CWE-686: Function Call With Incorrect Argument Type
            "CWE-662", # CWE-662 Improper Synchronization
        ],
        "icon": "inccalc"
    },
    "Spoofing":{
        "criticality": 0.4,
        "additional_detection_strings": ["allowed a remote attacker to spoof",
                                         "allowed a remote attacker to potentially spoof",
                                         "to spoof the contents",
                                         "spoof the location in the address bar",
                                         ],
        "icon": "spoofing"
    },
    "Tampering": {
        "criticality": 0.3,
        "additional_detection_strings": [],
        "icon": "tampering"
    },
    "Unknown Vulnerability Type": {
        "criticality": 0,
        "additional_detection_strings": [],
        "icon": "unknown"
    }
}

import re
def parser_tool():
    cwes = '''
CWE-770: Allocation of Resources Without Limits or Throttling
ParentOf	Variant	774	Allocation of File Descriptors or Handles Without Limits or Throttling
ParentOf	Variant	789	Memory Allocation with Excessive Size Value
ParentOf	Base	1325	Improperly Controlled Sequential Memory Allocation
    '''
    for line in cwes.split("\n"):
        new_line = re.sub("^[^0-9]*", "", line).replace(":","").replace("\t", " ")
        num_id = new_line.split(" ")[0]
        if num_id != "":
            print("\"CWE-" + num_id + "\", # CWE-" + new_line)

# parser_tool()
